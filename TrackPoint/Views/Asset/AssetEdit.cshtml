@model TrackPoint.Models.Asset

@{
    ViewData["Title"] = "Edit Asset";
}

/*
  Notes:
  - Category and Location selects expect SelectList in ViewBag.Categories and ViewBag.Locations:
      ViewBag.Categories = new SelectList(categories, "CategoryId", "Name", Model.CategoryId);
      ViewBag.Locations  = new SelectList(locations,  "LocationId", "Name", Model.LocationId);
  - Issued user select expects ViewBag.Users as SelectList: ("Id","UserName", Model.IssuedToUserId)
  - If those ViewBag entries are not provided the view falls back to displaying the current values.
*/

<h1>Edit Asset</h1>

<form asp-action="UpdateAsset" method="post" class="row g-3">
    @* Anti-forgery *@
    @Html.AntiForgeryToken()

    @* Internal ids *@
    <input asp-for="AssetId" type="hidden" />
    <input asp-for="AssetTag" type="hidden" />

    <div class="col-md-6">
        <label asp-for="AssetTag" class="form-label">Asset Tag</label>
        <input asp-for="AssetTag" class="form-control" readonly />
    </div>

    <div class="col-md-6">
        <label asp-for="Make" class="form-label">Make</label>
        <input asp-for="Make" class="form-control" />
    </div>

    <div class="col-md-6">
        <label asp-for="Model" class="form-label">Model</label>
        <input asp-for="Model" class="form-control" />
    </div>

    <div class="col-md-6">
        <label asp-for="SerialNumber" class="form-label">Serial Number</label>
        <input asp-for="SerialNumber" class="form-control" />
    </div>

    <div class="col-md-6">
        <label class="form-label">Category</label>
        @if (ViewBag.Categories != null)
        {
            <select asp-for="CategoryId" asp-items="ViewBag.Categories" class="form-select"></select>
        }
        else
        {
            <input class="form-control" value="@(Model.Category?.Name ?? $"{Model.CategoryId}")" readonly />
        }
    </div>

    <div class="col-md-6">
        <label class="form-label">Location</label>
        @if (ViewBag.Locations != null)
        {
            <select asp-for="LocationId" asp-items="ViewBag.Locations" class="form-select"></select>
        }
        else
        {
            <input class="form-control" value="@(Model.Location?.Name ?? $"{Model.LocationId}")" readonly />
        }
    </div>

    <div class="col-md-6">
        <label asp-for="IssuedToUserId" class="form-label">Issued To</label>
        @* Use IssuedToUserId to bind; ViewBag.Users should be a SelectList of Identity users (Id, UserName) *@
        @if (ViewBag.Users != null)
        {
            <select asp-for="IssuedToUserId" asp-items="ViewBag.Users" class="form-select">
                <option value="">-- Unassigned --</option>
            </select>
        }
        else
        {
            <input class="form-control" value="@(Model.IssuedToUser?.UserName ?? "—")" readonly />
            <input asp-for="IssuedToUserId" type="hidden" />
        }
    </div>

    <div class="col-md-6">
        <label asp-for="AssetStatus" class="form-label">Status</label>
        <select asp-for="AssetStatus" class="form-select">
            <option value="">Select Status</option>
            <option value="InUse" selected="@(Model.AssetStatus == "InUse")">In Use</option>
            <option value="InStorage" selected="@(Model.AssetStatus == "InStorage")">In Storage</option>
            <option value="UnderMaintenance" selected="@(Model.AssetStatus == "UnderMaintenance")">Under Maintenance</option>
            <option value="Retired" selected="@(Model.AssetStatus == "Retired")">Retired</option>
            <option value="PendingDeployment" selected="@(Model.AssetStatus == "PendingDeployment")">Pending Deployment</option>
            <option value="Lost" selected="@(Model.AssetStatus == "Lost")">Lost</option>
            <option value="Transfered" selected="@(Model.AssetStatus == "Transfered")">Transfered</option>
            <option value="NeedsReplacement" selected="@(Model.AssetStatus == "NeedsReplacement")">Needs Replacement</option>
            <option value="OnHold" selected="@(Model.AssetStatus == "OnHold")">On Hold</option>
            <option value="Returned" selected="@(Model.AssetStatus == "Returned")">Returned</option>
        </select>
    </div>

    <div class="col-md-4">
        <label asp-for="PurchaseDate" class="form-label">Purchase Date</label>
        <input asp-for="PurchaseDate" class="form-control" type="date" />
    </div>

    <div class="col-md-4">
        <label asp-for="WarrantyExpirationDate" class="form-label">Warranty Expiration</label>
        <input asp-for="WarrantyExpirationDate" class="form-control" type="date" />
    </div>

    <div class="col-md-4">
        <label asp-for="PurchasePrice" class="form-label">Purchase Price</label>
        <input asp-for="PurchasePrice" class="form-control" type="number" step="0.01" />
    </div>

    <div class="col-md-6">
        <label asp-for="Vendor" class="form-label">Vendor</label>
        <input asp-for="Vendor" class="form-control" />
    </div>

    <div class="col-md-6">
        <label asp-for="Condition" class="form-label">Condition</label>
        <input asp-for="Condition" class="form-control" />
    </div>

    <div class="col-12">
        <label asp-for="Notes" class="form-label">Notes</label>
        <textarea asp-for="Notes" class="form-control" rows="4">@Model.Notes</textarea>
    </div>

    <div class="col-12">
        <button type="submit" class="btn btn-primary">Save</button>
        <a asp-controller="Asset" asp-action="AssetBrowser" class="btn btn-secondary ms-2">Cancel</a>
    </div>
</form>