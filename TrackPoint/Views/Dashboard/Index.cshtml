@{
    ViewData["Title"] = "Dashboard";
}

<style>
    .custom-background {
        background-color: #f8f8f8;
    }
    .custom-select{
        background-color:#ffffff;
    }
</style>
<div class="container mt-4 custom-background">

    <h2 class="mb-3">Dashboard</h2> 

    <div class="container">
        <div class="row">
            <div class="col-sm custom-select">
                <h6>Assets by Location</h6>
                <canvas id="location"></canvas>
            </div>
            <div class="col-sm custom-select">
                <h6>Assets by Status</h6>
                <canvas id="status"></canvas>
            </div>
            <div class="col-sm custom-select">
                <h6>Assets by Make</h6>
                <canvas id="make"></canvas>
            </div>
            
        </div>
    </div>


    <div class="container">
        <h5>Filters</h5>

        <label for="statusF">Status: </label>
        <select id="statusF" name="statusFilter">
        </select>

        <label for="categoryF">Category: </label>
        <select id="categoryF" name="categoryFilter">
        </select>
    </div>

    <div class="container">
        <p>I want my search section to be here</p>
    </div>

    <div class="container mt-4">
        <table id="assetTable" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>Asset Tag</th>
                    <th>Make</th>
                    <th>Model</th>
                    <th>Category</th>
                    <th>Location</th>
                    <th>Issued To</th>
                    <th>Status</th>
                    <th>Notes</th>
                </tr>
            </thead>`   
            <tbody>
                <tr><td>LSNF-001</td><td>Dell</td><td>Latitude 7420</td><td>Tech</td><td>HQ Closet</td><td>Emily</td><td>InUse</td><td>Assigned</td></tr>
                <tr><td>LSNF-002</td><td>HP</td><td>ProBook</td><td>Tech</td><td>HQ Closet</td><td>—</td><td>InStorage</td><td>Spare</td></tr>
                <tr><td>LSNF-003</td><td>Epson</td><td>EX5280</td><td>Tech</td><td>Room 101</td><td>Alex</td><td>UnderMaintenance</td><td>Bulb</td></tr>
                <tr><td>LSNF-001</td><td>Dell</td><td>Latitude 7420</td><td>Tech</td><td>HQ Closet</td><td>Emily</td><td>InUse</td><td>Assigned</td></tr>
                <tr><td>LSNF-002</td><td>HP</td><td>ProBook</td><td>Tech</td><td>HQ Closet</td><td>—</td><td>InStorage</td><td>Spare</td></tr>
                <tr><td>LSNF-003</td><td>Epson</td><td>EX5280</td><td>Tech</td><td>Room 101</td><td>Alex</td><td>UnderMaintenance</td><td>Bulb</td></tr>
                <tr><td>LSNF-004</td><td>Lenovo</td><td>ThinkPad X13</td><td>Tech</td><td>Field Office</td><td>Sarah</td><td>CheckedOut</td><td>Used for outreach event</td></tr>
                <tr><td>LSNF-005</td><td>Canon</td><td>Pixma G3270</td><td>Tech</td><td>HQ Supply Room</td><td>—</td><td>InStorage</td><td>Spare printer</td></tr>
                <tr><td>LSNF-006</td><td>Microsoft</td><td>Surface Pro 7</td><td>Tech</td><td>HQ Desk 4</td><td>Michael</td><td>CheckedOut</td><td>Used for client presentation</td></tr>
                <tr><td>LSNF-007</td><td>Samsung</td><td>Galaxy Tab A7</td><td>Tech</td><td>Outreach Van</td><td>Jasmine</td><td>InUse</td><td>Deployed for field survey</td></tr>
                <tr><td>LSNF-008</td><td>Apple</td><td>MacBook Air M1</td><td>Tech</td><td>HQ Closet</td><td>—</td><td>PendingDeployment</td><td>New hire device</td></tr>
                <tr><td>LSNF-009</td><td>LG</td><td>Projector MiniBeam</td><td>Tech</td><td>Room 202</td><td>Jessica</td><td>CheckedOut</td><td>Training session</td></tr>
                <tr><td>LSNF-010</td><td>Amazon</td><td>Echo Dot</td><td>Non-Tech</td><td>Conference Room</td><td>—</td><td>InUse</td><td>Office automation</td></tr>
                <tr><td>LSNF-011</td><td>Brother</td><td>HL-L2350DW</td><td>Tech</td><td>HQ Printing Station</td><td>—</td><td>InUse</td><td>Main printer</td></tr>
                <tr><td>LSNF-012</td><td>Generic</td><td>Extension Cord</td><td>Non-Tech</td><td>Kit A</td><td>—</td><td>InStorage</td><td>Used for outreach setups</td></tr>
                <tr><td>LSNF-013</td><td>HP</td><td>EliteBook 840</td><td>Tech</td><td>Kit B</td><td>Anthony</td><td>CheckedOut</td><td>Field reporting</td></tr>
                <tr><td>LSNF-014</td><td>Canon</td><td>EOS Rebel T7</td><td>Tech</td><td>HQ Media Closet</td><td>—</td><td>InStorage</td><td>Photo documentation</td></tr>
                <tr><td>LSNF-015</td><td>Logitech</td><td>C920</td><td>Tech</td><td>HQ Closet</td><td>—</td><td>Retired</td><td>Outdated equipment</td></tr>
            </tbody>
        </table>
    </div>


    
</div>

<!-- DataTables + jQuery (CDN) -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!--This is the Datatables asset table-->
<script>
    $(document).ready(function () {
        $('#assetTable').DataTable({
            pageLength: 10,
            ordering: true,
            searching: true,
            stateSave: true,
        });

        // Create the category chart
        createCategoryChart();
        createStatusChart();
        createMakeChart();
        createLocationChart();
    });

    function createCategoryChart() {
        const dt = $('#assetTable').DataTable(); 
        const categoryData = dt.column(3).data().toArray();

        // Count occurrences of each category
        const categoryCounts = {};
        categoryData.forEach(category => {
            categoryCounts[category] = (categoryCounts[category] || 0) + 1;
        });

        const labels = Object.keys(categoryCounts);
        const values = Object.values(categoryCounts);


        const ctx = document.getElementById('category');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                  
                    data: values,
                    borderWidth: 2,
                    backgroundColor: 'rgba(54,162,235,0.5)',
                    borderColor: 'rgba(54,162,235,1)'
                }]
            },
            options: {
                plugins: { legend: { display: false } },
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
               
                }
            
        });
    }

     function createStatusChart() {
        const dt = $('#assetTable').DataTable();
        const statusData = dt.column(6).data().toArray();

        // Count occurrences of each category
        const statusCounts = {};
        statusData.forEach(status => {
            statusCounts[status] = (statusCounts[status] || 0) + 1;
        });

        const labels = Object.keys(statusCounts);
        const values = Object.values(statusCounts);

        console.log(labels, values);

        const ctx = document.getElementById('status');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Assets by status',
                    data: values,
                    borderWidth: 2,
                    backgroundColor: 'rgba(54,162,235,0.5)',
                    borderColor: 'rgba(54,162,235,1)'
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    }
        function createMakeChart() {
        const dt = $('#assetTable').DataTable();
        const makeData = dt.column(1).data().toArray();

        // Count occurrences of each make
        const makeCounts = {};
        makeData.forEach(make => {
            makeCounts[make] = (makeCounts[make] || 0) + 1;
        });

        const labels = Object.keys(makeCounts);
        const values = Object.values(makeCounts);

        console.log(labels, values);

        const ctx = document.getElementById('make');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Assets by Make',
                    data: values,
                    backgroundColor: 'rgba(54,162,235,0.5)',
                    borderColor: 'rgba(54,162,235,1)'
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    }

        function createLocationChart() {
        const dt = $('#assetTable').DataTable();
        const locationData = dt.column(4).data().toArray();

        // Count occurrences of each location
        const locationCounts = {};
        locationData.forEach(location => {
            locationCounts[location] = (locationCounts[location] || 0) + 1;
        });

        const labels = Object.keys(locationCounts);
        const values = Object.values(locationCounts);

        console.log(labels, values);

        const ctx = document.getElementById('location');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Assets by Location',
                    data: values,
                    borderWidth: 2,
                    backgroundColor: 'rgba(54,162,235,0.5)',
                    borderColor: 'rgba(54,162,235,1)'
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                },
                plugins: { legend: { display: false } }
            }
        });
    }
</script>

